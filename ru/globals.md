# Глобальные параметры расширения

Расширения PHP предоставляют способ определения глобальных переменных внутри расширения. Чтение/запись глобальных данных должны быть быстрее, чем любые другие глобальные механизмы (например, доступ к статическим членам). Глобальные переменные расширений можно использовать для настройки параметров конфигурации, которые изменяют поведение вашей библиотеки.

В Zephir глобальные переменные ограничены простыми скалярными типами типа `int`/`bool`/`double`/`char` и т.д. Здесь не допускаются комплексные типы, такие как строки/массивы/объекты/ресурсы.

Вы можете ввести глобальные переменные в расширение, добавив следующую структуру в `config.json`:

    {
        //...
        "globals": {
            "allow_some_feature": {
                "type": "bool",
                "default": true,
                "module": true
            },
            "number_times": {
                "type": "int",
                "default": 10
            },
            "some_component.my_setting_1": {
                "type": "bool",
                "default": true
            },
            "some_component.my_setting_2": {
                "type": "int",
                "default": 100
            }
        }
    }
    

Каждая глобальная секция имеет следующую структуру:

    "<global-name>": {
        "type": "<some-valid-type>",
        "default": <some-compatible-default-value>
    }
    

Составные (именованные) глобальные переменные имеют следующую структуру:

    "<namespace>.<global-name>": {
        "type": "<some-valid-type>",
        "default": <some-compatible-default-value>
    }
    

The optional `module` key, if present, places that global's initialization process into the module-wide `GINIT` lifecycle event, which just means it will only be set up once per PHP process, rather than being reinitialized for every request, which is the default:

##### `allow_some_feature"` is set up only once at startup; `number_times` is set up at the start of each request

    {
        //...
        "globals": {
            "allow_some_feature": {
                "type": "bool",
                "default": true,
                "module": true
            },
            "number_times": {
                "type": "int",
                "default": 10
            }
        }
    }
    

Внутри любого метода вы можете читать/писать глобальные переменные расширения с помощью встроенных функций `globals_get` и `globals_set`:

    globals_set("allow_some_feature", true);
    let someFeature = globals_get("allow_some_feature");
    

If you want to change these globals from PHP, a good option is include a method aimed at this:

    namespace Test;
    
    class MyOptions
    {
    
        public static function setOptions(array options)
        {
            boolean someOption, anotherOption;
    
            if fetch someOption, options["some_option"] {
                globals_set("some_option", someOption);
            }
    
            if fetch anotherOption, options["another_option"] {
                globals_set("another_option", anotherOption);
            }
        }
    }
    

Extension globals cannot be dynamically accessed, since the C code generated by the `globals_get`/`globals_set` optimizers must be resolved at compilation time:

    let myOption = "someOption";
    
    // will throw a compiler exception
    let someOption = globals_get(myOption);